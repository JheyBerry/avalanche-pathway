"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const buffer_1 = require("buffer/");
const payload_1 = require("src/utils/payload");
const bintools_1 = __importDefault(require("src/utils/bintools"));
const bn_js_1 = __importDefault(require("bn.js"));
const bech32 = __importStar(require("bech32"));
let payloadTypes = payload_1.PayloadTypes.getInstance();
let bintools = bintools_1.default.getInstance();
describe("Payload", () => {
    let hrp = "tests";
    let cb58str = "MBcQpm1PsdfBKYscN3AYP56MusRDMZGF9";
    let cb58buf = bintools.bufferToB58(bintools.cb58Decode(cb58str));
    let chex = "849c0F8c6d9942a2605517AeaBe00133Cb159f8D";
    let bech = bech32.encode(hrp, bech32.toWords(bintools.b58ToBuffer(cb58buf)));
    let binstr = "Bx4v7ytutz3";
    let utf8str = "I am the very model of a modern Major-General.";
    let utf8b58 = bintools.bufferToB58(buffer_1.Buffer.from(utf8str));
    let utf8hex = buffer_1.Buffer.from(utf8str).toString("hex");
    let utf8b64 = buffer_1.Buffer.from(utf8str).toString("base64");
    let bnhex = "deadbeef";
    let svgstr = "<svg>hi mom</svg>";
    let csvstr = "1,2,3,4,5\neverybody,in the,house,come along, let's ride";
    let jsonobj = { boom: "goes the dynamite" };
    let yamlstr = "---\nrootproperty: blah\nsection:\n  one: two\n  three: four\n  Foo: Bar\n  empty: ~";
    let emailstr = "example@example.com";
    let urlstr = "https://example.com";
    let ipfsstr = "QmUy4jh5mGNZvLkjies1RWM4YuvJh5o2FYopNPVYwrRVGV";
    let onionstr = "https://el33th4xor.onion";
    let magnetstr = "magnet:?xt=urn:btih:c12fe1c06bba254a9dc9f519b335aa7c1367a88a";
    test("PayloadTypes", () => {
        expect(() => { payloadTypes.select(867309); }).toThrow();
        expect(payloadTypes.lookupID("BIN")).toBe(0);
        let pl = payloadTypes.select(0, binstr);
        expect(payloadTypes.getTypeID(pl.toBuffer())).toBe(0);
        let pp = payloadTypes.getContent(pl.toBuffer());
        expect(bintools.b58ToBuffer(binstr).toString("hex")).toBe(pp.toString("hex"));
        expect(payloadTypes.lookupType(0)).toBe("BIN");
        expect(payloadTypes.recast(pl).toBuffer().toString("hex")).toBe(pl.toBuffer().toString("hex"));
    });
    let testTable = [
        ["BIN", binstr, binstr],
        ["UTF8", utf8str, utf8b58],
        ["HEXSTR", utf8hex, utf8b58],
        ["B58STR", utf8b58, utf8b58],
        ["B64STR", utf8b64, utf8b58],
        ["BIGNUM", bnhex, bintools.bufferToB58(buffer_1.Buffer.from(bnhex, "hex"))],
        ["XCHAINADDR", "X-" + bech, cb58buf],
        ["PCHAINADDR", "P-" + bech, cb58buf],
        ["CCHAINADDR", "C-0x" + chex, bintools.bufferToB58(buffer_1.Buffer.from(chex, "hex"))],
        ["TXID", cb58str, cb58buf],
        ["ASSETID", cb58str, cb58buf],
        ["UTXOID", cb58str, cb58buf],
        ["NFTID", cb58str, cb58buf],
        ["SUBNETID", cb58str, cb58buf],
        ["CHAINID", cb58str, cb58buf],
        ["NODEID", cb58str, cb58buf],
        ["SECPSIG", cb58str, cb58str],
        ["SECPENC", cb58str, cb58str],
        ["JPEG", binstr, binstr],
        ["PNG", binstr, binstr],
        ["BMP", binstr, binstr],
        ["ICO", binstr, binstr],
        ["SVG", svgstr, bintools.bufferToB58(buffer_1.Buffer.from(svgstr))],
        ["CSV", csvstr, bintools.bufferToB58(buffer_1.Buffer.from(csvstr))],
        ["JSON", JSON.stringify(jsonobj), bintools.bufferToB58(buffer_1.Buffer.from(JSON.stringify(jsonobj)))],
        ["YAML", yamlstr, bintools.bufferToB58(buffer_1.Buffer.from(yamlstr))],
        ["EMAIL", emailstr, bintools.bufferToB58(buffer_1.Buffer.from(emailstr))],
        ["URL", urlstr, bintools.bufferToB58(buffer_1.Buffer.from(urlstr))],
        ["IPFS", ipfsstr, ipfsstr],
        ["ONION", onionstr, bintools.bufferToB58(buffer_1.Buffer.from(onionstr))],
        ["MAGNET", magnetstr, bintools.bufferToB58(buffer_1.Buffer.from(magnetstr))]
    ];
    test.each(testTable)('Basic Payload Test: typestr %s; input %s; inputbuff %s', (typestr, inputstr, inputbuff) => {
        let buff = bintools.b58ToBuffer(inputbuff);
        let typeid = payloadTypes.lookupID(typestr);
        let typename = payloadTypes.lookupType(typeid);
        expect(typename).toBe(typestr);
        let c0 = payloadTypes.select(typeid);
        expect(c0.typeID()).toBe(typeid);
        expect(c0.typeName()).toBe(typename);
        let c1 = payloadTypes.select(typeid, buff);
        let c2 = payloadTypes.select(typeid, inputstr);
        let c3 = payloadTypes.select(typeid);
        c3.fromBuffer(c1.toBuffer());
        let c4 = payloadTypes.select(typeid);
        c4.fromBuffer(c2.toBuffer());
        let s1 = c1.toBuffer().toString("hex");
        let s2 = c2.toBuffer().toString("hex");
        let s3 = c3.toBuffer().toString("hex");
        let s4 = c4.toBuffer().toString("hex");
        expect(s1).toBe(s2);
        expect(s2).toBe(s3);
        expect(s3).toBe(s4);
    });
    test("BINPayload special cases", () => {
        let pl = payloadTypes.select(0, binstr);
        expect(bintools.bufferToB58(pl.returnType())).toBe(binstr);
    });
    test("UTF8Payload special cases", () => {
        let pl = new payload_1.UTF8Payload(utf8str);
        expect(pl.returnType()).toBe(utf8str);
    });
    test("HEXSTRPayload special cases", () => {
        let pl = new payload_1.HEXSTRPayload(utf8hex);
        expect(pl.returnType()).toBe(utf8hex);
    });
    test("B58STRPayload special cases", () => {
        let pl = new payload_1.B58STRPayload(utf8b58);
        expect(pl.returnType()).toBe(utf8b58);
    });
    test("B64STRPayload special cases", () => {
        let pl = new payload_1.B64STRPayload(utf8b64);
        expect(pl.returnType()).toBe(utf8b64);
    });
    test("BIGNUMPayload special cases", () => {
        let jenny = new bn_js_1.default(8675309);
        let pl = new payload_1.BIGNUMPayload(jenny);
        expect(pl.returnType().toString("hex")).toBe(jenny.toString("hex"));
    });
    test("XCHAINADDRPayload special cases", () => {
        let addr = "X-" + bech;
        let pl = new payload_1.XCHAINADDRPayload(addr);
        expect(pl.returnType(hrp)).toBe(addr);
        expect(pl.returnChainID()).toBe("X");
    });
    test("PCHAINADDRPayload special cases", () => {
        let addr = "P-" + bech;
        let pl = new payload_1.PCHAINADDRPayload(addr);
        expect(pl.returnType(hrp)).toBe(addr);
        expect(pl.returnChainID()).toBe("P");
    });
    test("CCHAINADDRPayload special cases", () => {
        let addr = "C-0x" + chex;
        let pl = new payload_1.CCHAINADDRPayload(addr);
        expect(pl.returnType()).toBe(addr);
        expect(pl.returnChainID()).toBe("C");
    });
    //handles all of cb58EncodedPayload
    test("TXIDPayload special cases", () => {
        let pl = new payload_1.TXIDPayload(cb58str);
        expect(pl.returnType()).toBe(cb58str);
    });
    test("JSONPayload special cases", () => {
        let pl = new payload_1.JSONPayload(jsonobj);
        expect(JSON.stringify(pl.returnType())).toBe(JSON.stringify(jsonobj));
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGF5bG9hZC50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vdGVzdHMvY29tbW9uL3BheWxvYWQudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSxvQ0FBaUM7QUFDakMsK0NBQXNPO0FBQ3RPLGtFQUEwQztBQUMxQyxrREFBdUI7QUFDdkIsK0NBQWlDO0FBQ2pDLElBQUksWUFBWSxHQUFnQixzQkFBWSxDQUFDLFdBQVcsRUFBRSxDQUFDO0FBQzNELElBQUksUUFBUSxHQUFHLGtCQUFRLENBQUMsV0FBVyxFQUFFLENBQUE7QUFFckMsUUFBUSxDQUFDLFNBQVMsRUFBRSxHQUFHLEVBQUU7SUFDckIsSUFBSSxHQUFHLEdBQVUsT0FBTyxDQUFDO0lBRXpCLElBQUksT0FBTyxHQUFVLG1DQUFtQyxDQUFDO0lBQ3pELElBQUksT0FBTyxHQUFVLFFBQVEsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0lBQ3hFLElBQUksSUFBSSxHQUFVLDBDQUEwQyxDQUFDO0lBQzdELElBQUksSUFBSSxHQUFVLE1BQU0sQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDcEYsSUFBSSxNQUFNLEdBQVUsYUFBYSxDQUFDO0lBQ2xDLElBQUksT0FBTyxHQUFVLGdEQUFnRCxDQUFDO0lBQ3RFLElBQUksT0FBTyxHQUFVLFFBQVEsQ0FBQyxXQUFXLENBQUMsZUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0lBQ2hFLElBQUksT0FBTyxHQUFVLGVBQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzFELElBQUksT0FBTyxHQUFVLGVBQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzdELElBQUksS0FBSyxHQUFVLFVBQVUsQ0FBQztJQUM5QixJQUFJLE1BQU0sR0FBVSxtQkFBbUIsQ0FBQztJQUN4QyxJQUFJLE1BQU0sR0FBVSwwREFBMEQsQ0FBQztJQUMvRSxJQUFJLE9BQU8sR0FBVSxFQUFDLElBQUksRUFBQyxtQkFBbUIsRUFBQyxDQUFDO0lBQ2hELElBQUksT0FBTyxHQUFVLHNGQUFzRixDQUFDO0lBQzVHLElBQUksUUFBUSxHQUFVLHFCQUFxQixDQUFDO0lBQzVDLElBQUksTUFBTSxHQUFVLHFCQUFxQixDQUFDO0lBQzFDLElBQUksT0FBTyxHQUFVLGdEQUFnRCxDQUFDO0lBQ3RFLElBQUksUUFBUSxHQUFVLDBCQUEwQixDQUFDO0lBQ2pELElBQUksU0FBUyxHQUFVLDhEQUE4RCxDQUFDO0lBSXRGLElBQUksQ0FBQyxjQUFjLEVBQUUsR0FBRyxFQUFFO1FBQ3RCLE1BQU0sQ0FBQyxHQUFHLEVBQUUsR0FBRSxZQUFZLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFBLENBQUEsQ0FBQyxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7UUFFdEQsTUFBTSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFN0MsSUFBSSxFQUFFLEdBQWMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsTUFBTSxDQUFlLENBQUM7UUFFakUsTUFBTSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFdEQsSUFBSSxFQUFFLEdBQVUsWUFBWSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztRQUV2RCxNQUFNLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzlFLE1BQU0sQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQy9DLE1BQU0sQ0FBQyxZQUFZLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7SUFDbkcsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFJLFNBQVMsR0FBRztRQUNaLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUM7UUFDdkIsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQztRQUMxQixDQUFDLFFBQVEsRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDO1FBQzVCLENBQUMsUUFBUSxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUM7UUFDNUIsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQztRQUM1QixDQUFDLFFBQVEsRUFBRSxLQUFLLEVBQUUsUUFBUSxDQUFDLFdBQVcsQ0FBQyxlQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQ2xFLENBQUMsWUFBWSxFQUFFLElBQUksR0FBRyxJQUFJLEVBQUUsT0FBTyxDQUFDO1FBQ3BDLENBQUMsWUFBWSxFQUFFLElBQUksR0FBRyxJQUFJLEVBQUUsT0FBTyxDQUFDO1FBQ3BDLENBQUMsWUFBWSxFQUFFLE1BQU0sR0FBRyxJQUFJLEVBQUUsUUFBUSxDQUFDLFdBQVcsQ0FBQyxlQUFNLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO1FBQzdFLENBQUMsTUFBTSxFQUFF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Q0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDckMsSUFBSSxFQUFFLEdBQWUsWUFBWSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDdkQsSUFBSSxFQUFFLEdBQWUsWUFBWSxDQUFDLE1BQU0sQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDM0QsSUFBSSxFQUFFLEdBQWUsWUFBWSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNqRCxFQUFFLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO1FBQzdCLElBQUksRUFBRSxHQUFlLFlBQVksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDakQsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztRQUU3QixJQUFJLEVBQUUsR0FBVSxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzlDLElBQUksRUFBRSxHQUFVLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDOUMsSUFBSSxFQUFFLEdBQVUsRUFBRSxDQUFDLFFBQVEsRUFBRSxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUM5QyxJQUFJLEVBQUUsR0FBVSxFQUFFLENBQUMsUUFBUSxFQUFFLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRTlDLE1BQU0sQ0FBQyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDcEIsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNwQixNQUFNLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQ3hCLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBSSxD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QUMsQ0FBQztJQUN6QyxDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7UUFDekMsSUFBSSxJQUFJLEdBQVUsTUFBTSxHQUFHLElBQUksQ0FBQztRQUNoQyxJQUFJLEVBQUUsR0FBcUIsSUFBSSwyQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN2RCxNQUFNLENBQUMsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ25DLE1BQU0sQ0FBQyxFQUFFLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDekMsQ0FBQyxDQUFDLENBQUM7SUFFSCxtQ0FBbUM7SUFDbkMsSUFBSSxDQUFDLDJCQUEyQixFQUFFLEdBQUcsRUFBRTtRQUNuQyxJQUFJLEVBQUUsR0FBZSxJQUFJLHFCQUFXLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDOUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMxQyxDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQywyQkFBMkIsRUFBRSxHQUFHLEVBQUU7UUFDbkMsSUFBSSxFQUFFLEdBQWUsSUFBSSxxQkFBVyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzlDLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztJQUMxRSxDQUFDLENBQUMsQ0FBQztBQUVYLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQnVmZmVyIH0gZnJvbSBcImJ1ZmZlci9cIjtcbmltcG9ydCB7IFBheWxvYWRUeXBlcywgQklOUGF5bG9hZCwgUGF5bG9hZEJhc2UsIFVURjhQYXlsb2FkLCBIRVhTVFJQYXlsb2FkLCBCNThTVFJQYXlsb2FkLCBCNjRTVFJQYXlsb2FkLCBCSUdOVU1QYXlsb2FkLCBYQ0hBSU5BRERSUGF5bG9hZCwgUENIQUlOQUREUlBheWxvYWQsIENDSEFJTkFERFJQYXlsb2FkLCBUWElEUGF5bG9hZCwgSlNPTlBheWxvYWQgfSBmcm9tICdzcmMvdXRpbHMvcGF5bG9hZCc7XG5pbXBvcnQgQmluVG9vbHMgZnJvbSAnc3JjL3V0aWxzL2JpbnRvb2xzJztcbmltcG9ydCBCTiBmcm9tIFwiYm4uanNcIjtcbmltcG9ydCAqIGFzIGJlY2gzMiBmcm9tICdiZWNoMzInO1xubGV0IHBheWxvYWRUeXBlczpQYXlsb2FkVHlwZXMgPSBQYXlsb2FkVHlwZXMuZ2V0SW5zdGFuY2UoKTtcbmxldCBiaW50b29scyA9IEJpblRvb2xzLmdldEluc3RhbmNlKClcblxuZGVzY3JpYmUoXCJQYXlsb2FkXCIsICgpID0+IHtcbiAgICBsZXQgaHJwOnN0cmluZyA9IFwidGVzdHNcIjtcblxuICAgIGxldCBjYjU4c3RyOnN0cmluZyA9IFwiTUJjUXBtMVBzZGZCS1lzY04zQVlQNTZNdXNSRE1aR0Y5XCI7XG4gICAgbGV0IGNiNThidWY6c3RyaW5nID0gYmludG9vbHMuYnVmZmVyVG9CNTgoYmludG9vbHMuY2I1OERlY29kZShjYjU4c3RyKSk7XG4gICAgbGV0IGNoZXg6c3RyaW5nID0gXCI4NDljMEY4YzZkOTk0MmEyNjA1NTE3QWVhQmUwMDEzM0NiMTU5ZjhEXCI7XG4gICAgbGV0IGJlY2g6c3RyaW5nID0gYmVjaDMyLmVuY29kZShocnAsIGJlY2gzMi50b1dvcmRzKGJpbnRvb2xzLmI1OFRvQnVmZmVyKGNiNThidWYpKSk7XG4gICAgbGV0IGJpbnN0cjpzdHJpbmcgPSBcIkJ4NHY3eXR1dHozXCI7XG4gICAgbGV0IHV0ZjhzdHI6c3RyaW5nID0gXCJJIGFtIHRoZSB2ZXJ5IG1vZGVsIG9mIGEgbW9kZXJuIE1ham9yLUdlbmVyYWwuXCI7XG4gICAgbGV0IHV0ZjhiNTg6c3RyaW5nID0gYmludG9vbHMuYnVmZmVyVG9CNTgoQnVmZmVyLmZyb20odXRmOHN0cikpO1xuICAgIGxldCB1dGY4aGV4OnN0cmluZyA9IEJ1ZmZlci5mcm9tKHV0ZjhzdHIpLnRvU3RyaW5nKFwiaGV4XCIpO1xuICAgIGxldCB1dGY4YjY0OnN0cmluZyA9IEJ1ZmZlci5mcm9tKHV0ZjhzdHIpLnRvU3RyaW5nKFwiYmFzZTY0XCIpO1xuICAgIGxldCBibmhleDpzdHJpbmcgPSBcImRlYWRiZWVmXCI7XG4gICAgbGV0IHN2Z3N0cjpzdHJpbmcgPSBcIjxzdmc+aGkgbW9tPC9zdmc+XCI7XG4gICAgbGV0IGNzdnN0cjpzdHJpbmcgPSBcIjEsMiwzLDQsNVxcbmV2ZXJ5Ym9keSxpbiB0aGUsaG91c2UsY29tZSBhbG9uZywgbGV0J3MgcmlkZVwiO1xuICAgIGxldCBqc29ub2JqOm9iamVjdCA9IHtib29tOlwiZ29lcyB0aGUgZHluYW1pdGVcIn07XG4gICAgbGV0IHlhbWxzdHI6c3RyaW5nID0gXCItLS1cXG5yb290cHJvcGVydHk6IGJsYWhcXG5zZWN0aW9uOlxcbiAgb25lOiB0d29cXG4gIHRocmVlOiBmb3VyXFxuICBGb286IEJhclxcbiAgZW1wdHk6IH5cIjtcbiAgICBsZXQgZW1haWxzdHI6c3RyaW5nID0gXCJleGFtcGxlQGV4YW1wbGUuY29tXCI7XG4gICAgbGV0IHVybHN0cjpzdHJpbmcgPSBcImh0dHBzOi8vZXhhbXBsZS5jb21cIjtcbiAgICBsZXQgaXBmc3N0cjpzdHJpbmcgPSBcIlFtVXk0amg1bUdOWnZMa2ppZXMxUldNNFl1dkpoNW8yRllvcE5QVll3clJWR1ZcIjtcbiAgICBsZXQgb25pb25zdHI6c3RyaW5nID0gXCJodHRwczovL2VsMzN0aDR4b3Iub25pb25cIjtcbiAgICBsZXQgbWFnbmV0c3RyOnN0cmluZyA9IFwibWFnbmV0Oj94dD11cm46YnRpaDpjMTJmZTFjMDZiYmEyNTRhOWRjOWY1MTliMzM1YWE3YzEzNjdhODhhXCI7XG5cbiAgICBcblxuICAgIHRlc3QoXCJQYXlsb2FkVHlwZXNcIiwgKCkgPT4ge1xuICAgICAgICBleHBlY3QoKCkgPT4ge3BheWxvYWRUeXBlcy5zZWxlY3QoODY3MzA5KX0pLnRvVGhyb3coKTtcblxuICAgICAgICBleHBlY3QocGF5bG9hZFR5cGVzLmxvb2t1cElEKFwiQklOXCIpKS50b0JlKDApO1xuXG4gICAgICAgIGxldCBwbDpCSU5QYXlsb2FkID0gcGF5bG9hZFR5cGVzLnNlbGVjdCgwLCBiaW5zdHIpIGFzIEJJTlBheWxvYWQ7XG5cbiAgICAgICAgZXhwZWN0KHBheWxvYWRUeXBlcy5nZXRUeXBlSUQocGwudG9CdWZmZXIoKSkpLnRvQmUoMCk7XG5cbiAgICAgICAgbGV0IHBwOkJ1ZmZlciA9IHBheWxvYWRUeXBlcy5nZXRDb250ZW50KHBsLnRvQnVmZmVyKCkpO1xuXG4gICAgICAgIGV4cGVjdChiaW50b29scy5iNThUb0J1ZmZlcihiaW5zdHIpLnRvU3RyaW5nKFwiaGV4XCIpKS50b0JlKHBwLnRvU3RyaW5nKFwiaGV4XCIpKTtcbiAgICAgICAgZXhwZWN0KHBheWxvYWRUeXBlcy5sb29rdXBUeXBlKDApKS50b0JlKFwiQklOXCIpO1xuICAgICAgICBleHBlY3QocGF5bG9hZFR5cGVzLnJlY2FzdChwbCkudG9CdWZmZXIoKS50b1N0cmluZyhcImhleFwiKSkudG9CZShwbC50b0J1ZmZlcigpLnRvU3RyaW5nKFwiaGV4XCIpKTtcbiAgICB9KTtcblxuICAgIGxldCB0ZXN0VGFibGUgPSBbXG4gICAgICAgIFtcIkJJTlwiLCBiaW5zdHIsIGJpbnN0cl0sIFxuICAgICAgICBbXCJVVEY4XCIsIHV0ZjhzdHIsIHV0ZjhiNThdLCBcbiAgICAgICAgW1wiSEVYU1RSXCIsIHV0ZjhoZXgsIHV0ZjhiNThdLCBcbiAgICAgICAgW1wiQjU4U1RSXCIsIHV0ZjhiNTgsIHV0ZjhiNThdLCBcbiAgICAgICAgW1wiQjY0U1RSXCIsIHV0ZjhiNjQsIHV0ZjhiNThdLCBcbiAgICAgICAgW1wiQklHTlVNXCIsIGJuaGV4LCBiaW50b29scy5idWZmZXJUb0I1OChCdWZmZXIuZnJvbShibmhleCwgXCJoZXhcIikpXSwgXG4gICAgICAgIFtcIlhDSEFJTkFERFJcIiwgXCJYLVwiICsgYmVjaCwgY2I1OGJ1Zl0sIFxuICAgICAgICBbXCJQQ0hBSU5BRERSXCIsIFwiUC1cIiArIGJlY2gsIGNiNThidWZdLCBcbiAgICAgICAgW1wiQ0NIQUlOQUREUlwiLCBcIkMtMHhcIiArIGNoZXgsIGJpbnRvb2xzLmJ1ZmZlclRvQjU4KEJ1ZmZlci5mcm9tKGNoZXgsIFwiaGV4XCIpKV0sIFxuICAgICAgICBbXCJUWElEXCIsIGNiNThzdHIsIGNiNThidWZdLCBcbiAgICAgICAgW1wiQVNTRVRJRFwiLCBjYjU4c3RyLCBjYjU4YnVmXSwgXG4gICAgICAgIFtcIlVUWE9JRFwiLCAgY2I1OHN0ciwgY2I1OGJ1Zl0sIFxuICAgICAgICBbXCJORlRJRFwiLCBjYjU4c3RyLCBjYjU4YnVmXSwgXG4gICAgICAgIFtcIlNVQk5FVElEXCIsIGNiNThzdHIsIGNiNThidWZdLCBcbiAgICAgICAgW1wiQ0hBSU5JRFwiLCBjYjU4c3RyLCBjYjU4YnVmXSwgXG4gICAgICAgIFtcIk5PREVJRFwiLCBjYjU4c3RyLCBjYjU4YnVmXSwgXG4gICAgICAgIFtcIlNFQ1BTSUdcIiwgY2I1OHN0ciwgY2I1OHN0cl0sIFxuICAgICAgICBbXCJTRUNQRU5DXCIsIGNiNThzdHIsIGNiNThzdHJdLCBcbiAgICAgICAgW1wiSlBFR1wiLCBiaW5zdHIsIGJpbnN0cl0sIFxuICAgICAgICBbXCJQTkdcIiwgYmluc3RyLCBiaW5zdHJdLCBcbiAgICAgICAgW1wiQk1QXCIsIGJpbnN0ciwgYmluc3RyXSwgXG4gICAgICAgIFtcIklDT1wiLCBiaW5zdHIsIGJpbnN0cl0sIFxuICAgICAgICBbXCJTVkdcIiwgc3Znc3RyLCBiaW50b29scy5idWZmZXJUb0I1OChCdWZmZXIuZnJvbShzdmdzdHIpKV0sIFxuICAgICAgICBbXCJDU1ZcIiwgY3N2c3RyLCBiaW50b29scy5idWZmZXJUb0I1OChCdWZmZXIuZnJvbShjc3ZzdHIpKV0sIFxuICAgICAgICBbXCJKU09OXCIsIEpTT04uc3RyaW5naWZ5KGpzb25vYmopLCBiaW50b29scy5idWZmZXJUb0I1OChCdWZmZXIuZnJvbShKU09OLnN0cmluZ2lmeShqc29ub2JqKSkpXSwgXG4gICAgICAgIFtcIllBTUxcIiwgeWFtbHN0ciwgYmludG9vbHMuYnVmZmVyVG9CNTgoQnVmZmVyLmZyb20oeWFtbHN0cikpXSwgXG4gICAgICAgIFtcIkVNQUlMXCIsIGVtYWlsc3RyLCBiaW50b29scy5idWZmZXJUb0I1OChCdWZmZXIuZnJvbShlbWFpbHN0cikpXSwgXG4gICAgICAgIFtcIlVSTFwiLCB1cmxzdHIsIGJpbnRvb2xzLmJ1ZmZlclRvQjU4KEJ1ZmZlci5mcm9tKHVybHN0cikpXSwgXG4gICAgICAgIFtcIklQRlNcIiwgaXBmc3N0ciwgaXBmc3N0cl0sIFxuICAgICAgICBbXCJPTklPTlwiLCBvbmlvbnN0ciwgYmludG9vbHMuYnVmZmVyVG9CNTgoQnVmZmVyLmZyb20ob25pb25zdHIpKV0sIFxuICAgICAgICBbXCJNQUdORVRcIiwgbWFnbmV0c3RyLCBiaW50b29scy5idWZmZXJUb0I1OChCdWZmZXIuZnJvbShtYWduZXRzdHIpKV1cbiAgICBdO1xuICAgIHRlc3QuZWFjaCh0ZXN0VGFibGUpKFxuICAgICAgICAnQmFzaWMgUGF5bG9hZCBUZXN0OiB0eXBlc3RyICVzOyBpbnB1dCAlczsgaW5wdXRidWZmICVzJyxcbiAgICAgICAgKFxuICAgICAgICAgICAgdHlwZXN0cjpzdHJpbmcsIGlucHV0c3RyOnN0cmluZywgaW5wdXRidWZmOnN0cmluZ1xuICAgICAgICApID0+IHtcbiAgICAgICAgICAgIGxldCBidWZmOkJ1ZmZlciA9IGJpbnRvb2xzLmI1OFRvQnVmZmVyKGlucHV0YnVmZik7XG4gICAgICAgICAgICBsZXQgdHlwZWlkOm51bWJlciA9IHBheWxvYWRUeXBlcy5sb29rdXBJRCh0eXBlc3RyKTtcbiAgICAgICAgICAgIGxldCB0eXBlbmFtZTpzdHJpbmcgPSBwYXlsb2FkVHlwZXMubG9va3VwVHlwZSh0eXBlaWQpO1xuICAgICAgICAgICAgZXhwZWN0KHR5cGVuYW1lKS50b0JlKHR5cGVzdHIpO1xuICAgICAgICAgICAgbGV0IGMwOlBheWxvYWRCYXNlID0gcGF5bG9hZFR5cGVzLnNlbGVjdCh0eXBlaWQpO1xuICAgICAgICAgICAgZXhwZWN0KGMwLnR5cGVJRCgpKS50b0JlKHR5cGVpZCk7XG4gICAgICAgICAgICBleHBlY3QoYzAudHlwZU5hbWUoKSkudG9CZSh0eXBlbmFtZSk7XG4gICAgICAgICAgICBsZXQgYzE6UGF5bG9hZEJhc2UgPSBwYXlsb2FkVHlwZXMuc2VsZWN0KHR5cGVpZCwgYnVmZik7XG4gICAgICAgICAgICBsZXQgYzI6UGF5bG9hZEJhc2UgPSBwYXlsb2FkVHlwZXMuc2VsZWN0KHR5cGVpZCwgaW5wdXRzdHIpO1xuICAgICAgICAgICAgbGV0IGMzOlBheWxvYWRCYXNlID0gcGF5bG9hZFR5cGVzLnNlbGVjdCh0eXBlaWQpO1xuICAgICAgICAgICAgYzMuZnJvbUJ1ZmZlcihjMS50b0J1ZmZlcigpKTtcbiAgICAgICAgICAgIGxldCBjNDpQYXlsb2FkQmFzZSA9IHBheWxvYWRUeXBlcy5zZWxlY3QodHlwZWlkKTtcbiAgICAgICAgICAgIGM0LmZyb21CdWZmZXIoYzIudG9CdWZmZXIoKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGxldCBzMTpzdHJpbmcgPSBjMS50b0J1ZmZlcigpLnRvU3RyaW5nKFwiaGV4XCIpO1xuICAgICAgICAgICAgbGV0IHMyOnN0cmluZyA9IGMyLnRvQnVmZmVyKCkudG9TdHJpbmcoXCJoZXhcIik7XG4gICAgICAgICAgICBsZXQgczM6c3RyaW5nID0gYzMudG9CdWZmZXIoKS50b1N0cmluZyhcImhleFwiKTtcbiAgICAgICAgICAgIGxldCBzNDpzdHJpbmcgPSBjNC50b0J1ZmZlcigpLnRvU3RyaW5nKFwiaGV4XCIpO1xuXG4gICAgICAgICAgICBleHBlY3QoczEpLnRvQmUoczIpO1xuICAgICAgICAgICAgZXhwZWN0KHMyKS50b0JlKHMzKTtcbiAgICAgICAgICAgIGV4cGVjdChzMykudG9CZShzNCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJCSU5QYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBsOkJJTlBheWxvYWQgPSBwYXlsb2FkVHlwZXMuc2VsZWN0KDAsIGJpbnN0cikgYXMgQklOUGF5bG9hZDtcbiAgICAgICAgICAgIGV4cGVjdChiaW50b29scy5idWZmZXJUb0I1OChwbC5yZXR1cm5UeXBlKCkpKS50b0JlKGJpbnN0cik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJVVEY4UGF5bG9hZCBzcGVjaWFsIGNhc2VzXCIsICgpID0+IHtcbiAgICAgICAgICAgIGxldCBwbDpVVEY4UGF5bG9hZCA9IG5ldyBVVEY4UGF5bG9hZCh1dGY4c3RyKTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5UeXBlKCkpLnRvQmUodXRmOHN0cik7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJIRVhTVFJQYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBsOkhFWFNUUlBheWxvYWQgPSBuZXcgSEVYU1RSUGF5bG9hZCh1dGY4aGV4KTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5UeXBlKCkpLnRvQmUodXRmOGhleCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJCNThTVFJQYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBsOkI1OFNUUlBheWxvYWQgPSBuZXcgQjU4U1RSUGF5bG9hZCh1dGY4YjU4KTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5UeXBlKCkpLnRvQmUodXRmOGI1OCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJCNjRTVFJQYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IHBsOkI2NFNUUlBheWxvYWQgPSBuZXcgQjY0U1RSUGF5bG9hZCh1dGY4YjY0KTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5UeXBlKCkpLnRvQmUodXRmOGI2NCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRlc3QoXCJCSUdOVU1QYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGplbm55OkJOID0gbmV3IEJOKDg2NzUzMDkpO1xuICAgICAgICAgICAgbGV0IHBsOkJJR05VTVBheWxvYWQgPSBuZXcgQklHTlVNUGF5bG9hZChqZW5ueSk7XG4gICAgICAgICAgICBleHBlY3QocGwucmV0dXJuVHlwZSgpLnRvU3RyaW5nKFwiaGV4XCIpKS50b0JlKGplbm55LnRvU3RyaW5nKFwiaGV4XCIpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdChcIlhDSEFJTkFERFJQYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGFkZHI6c3RyaW5nID0gXCJYLVwiICsgYmVjaDtcbiAgICAgICAgICAgIGxldCBwbDpYQ0hBSU5BRERSUGF5bG9hZCA9IG5ldyBYQ0hBSU5BRERSUGF5bG9hZChhZGRyKTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5UeXBlKGhycCkpLnRvQmUoYWRkcik7XG4gICAgICAgICAgICBleHBlY3QocGwucmV0dXJuQ2hhaW5JRCgpKS50b0JlKFwiWFwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdChcIlBDSEFJTkFERFJQYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGFkZHI6c3RyaW5nID0gXCJQLVwiICsgYmVjaDtcbiAgICAgICAgICAgIGxldCBwbDpQQ0hBSU5BRERSUGF5bG9hZCA9IG5ldyBQQ0hBSU5BRERSUGF5bG9hZChhZGRyKTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5UeXBlKGhycCkpLnRvQmUoYWRkcik7XG4gICAgICAgICAgICBleHBlY3QocGwucmV0dXJuQ2hhaW5JRCgpKS50b0JlKFwiUFwiKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGVzdChcIkNDSEFJTkFERFJQYXlsb2FkIHNwZWNpYWwgY2FzZXNcIiwgKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGFkZHI6c3RyaW5nID0gXCJDLTB4XCIgKyBjaGV4O1xuICAgICAgICAgICAgbGV0IHBsOkNDSEFJTkFERFJQYXlsb2FkID0gbmV3IENDSEFJTkFERFJQYXlsb2FkKGFkZHIpO1xuICAgICAgICAgICAgZXhwZWN0KHBsLnJldHVyblR5cGUoKSkudG9CZShhZGRyKTtcbiAgICAgICAgICAgIGV4cGVjdChwbC5yZXR1cm5DaGFpbklEKCkpLnRvQmUoXCJDXCIpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvL2hhbmRsZXMgYWxsIG9mIGNiNThFbmNvZGVkUGF5bG9hZFxuICAgICAgICB0ZXN0KFwiVFhJRFBheWxvYWQgc3BlY2lhbCBjYXNlc1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgcGw6VFhJRFBheWxvYWQgPSBuZXcgVFhJRFBheWxvYWQoY2I1OHN0cik7XG4gICAgICAgICAgICBleHBlY3QocGwucmV0dXJuVHlwZSgpKS50b0JlKGNiNThzdHIpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0ZXN0KFwiSlNPTlBheWxvYWQgc3BlY2lhbCBjYXNlc1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBsZXQgcGw6SlNPTlBheWxvYWQgPSBuZXcgSlNPTlBheWxvYWQoanNvbm9iaik7XG4gICAgICAgICAgICBleHBlY3QoSlNPTi5zdHJpbmdpZnkocGwucmV0dXJuVHlwZSgpKSkudG9CZShKU09OLnN0cmluZ2lmeShqc29ub2JqKSk7XG4gICAgICAgIH0pO1xuXG59KTtcbiJdfQ==